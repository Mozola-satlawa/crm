<!doctype html>
<html lang="pl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>ARKON — Dotacje „Mój Prąd” — kalkulator</title>
<meta name="description" content="Szybkie wyliczenie dotacji: panele + magazyn ciepła, panele + magazyn energii, sam magazyn energii. Limit 50% kosztów. Wydruk.">
<style>
  :root{ --bg:#0a0f1e; --ink:#e8edff; --muted:#aeb8da; --line:#243059; --card:#0f1533; --card2:#121a34; --ok:#2b8a57; --accent:#4cc9f0; }
  *{box-sizing:border-box}
  body{margin:0;background:linear-gradient(180deg,#0a0f1e,#0c1230 60%,#0a0f1e);color:var(--ink);font:15px/1.5 system-ui,Segoe UI,Roboto,Arial}
  header{padding:16px;background:#11183a;border-bottom:1px solid var(--line)}
  header h1{margin:0;font-size:22px}
  .wrap{max-width:900px;margin:auto;padding:16px}
  .card{background:linear-gradient(180deg,#0f1533,#121a34);border:1px solid var(--line);border-radius:14px;padding:14px}
  .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
  .grid{display:grid;gap:12px}
  @media(min-width:820px){ .cols-2{grid-template-columns:1fr 1fr} }
  input,select{background:#0d1530;border:1px solid #28356c;border-radius:10px;padding:8px 10px;color:var(--ink);font:inherit}
  label{display:block;margin-bottom:6px}
  table{width:100%;border-collapse:separate;border-spacing:0}
  th,td{padding:9px;border-bottom:1px solid #243059;text-align:left;vertical-align:top}
  th{font-size:13px;color:#aeb8da;white-space:nowrap}
  .btn{background:#233261;border:1px solid #3a4ca3;color:#fff;border-radius:10px;padding:8px 12px;cursor:pointer}
  .btn.ghost{background:transparent;border:1px dashed #3a4ca3}
  .big{font-size:26px;font-weight:800}
  @media print{ .no-print{display:none!important} body{background:#fff;color:#000} header{background:#fff;border:none} .card{border:none} }
</style>
</head>
<body>
<header>
  <div class="row">
    <h1>Dotacje „Mój Prąd” — kalkulator</h1>
    <a href="index.html" class="btn ghost no-print">⬅︎ Wróć do kalkulatora</a>
  </div>
  <div class="muted">Ustaw potencjalne kwoty dotacji (edytowalne) i policz wynik z limitem 50% kosztów kwalifikowanych. Wynik możesz wydrukować.</div>
</header>

<div class="wrap grid cols-2">
  <section class="card">
    <h2 style="margin:0 0 8px">Wejście</h2>
    <div class="grid cols-2">
      <div><label>Koszt paneli + osprzętu (netto)</label><input id="cost_pv" type="number" min="0" step="100" value="30000"></div>
      <div><label>Koszt magazynu energii (netto)</label><input id="cost_bat" type="number" min="0" step="100" value="0"></div>
      <div><label>Koszt magazynu ciepła (netto)</label><input id="cost_heat" type="number" min="0" step="100" value="0"></div>
      <div><label>VAT (%)</label><input id="vat" type="number" min="0" step="1" value="8"></div>
    </div>

    <h3 style="margin:10px 0 6px">Limity dotacji (edytowalne)</h3>
    <div class="grid cols-2">
      <div><label>PV + magazyn ciepła</label><input id="lim_pv_heat" type="number" min="0" step="500" value="12000"></div>
      <div><label>PV + magazyn energii</label><input id="lim_pv_bat" type="number" min="0" step="500" value="23000"></div>
      <div><label>Sam magazyn energii</label><input id="lim_bat_only" type="number" min="0" step="500" value="16000"></div>
      <div><label>Maks. udział dotacji</label><select id="share"><option value="0.5" selected>50%</option><option value="0.4">40%</option><option value="0.3">30%</option></select></div>
    </div>

    <div class="row" style="margin-top:10px">
      <button id="calc" class="btn ok">Przelicz</button>
      <button id="print" class="btn ghost">Drukuj / PDF</button>
      <button id="reset" class="btn ghost">Wyczyść</button>
    </div>
  </section>

  <section class="card">
    <h2 style="margin:0 0 8px">Wynik</h2>
    <table><tbody id="rows"></tbody></table>
    <div class="big" id="summary">—</div>
  </section>
</div>

<script>
'use strict';
const $=s=>document.querySelector(s);
const INT0=new Intl.NumberFormat('pl-PL',{maximumFractionDigits:0});
const money=n=> INT0.format(Math.round(+n))+' zł';

function cap50(grant, cost, share){ return Math.min(+grant||0, (+cost||0)*(+share||0.5)); }

function recalc(){
  const pv=+$('#cost_pv').value||0, bat=+$('#cost_bat').value||0, heat=+$('#cost_heat').value||0;
  const vat=(+$('#vat').value||0)/100, share=+$('#share').value||0.5;
  const limPVHeat=+$('#lim_pv_heat').value||0, limPVBat=+$('#lim_pv_bat').value||0, limBatOnly=+$('#lim_bat_only').value||0;

  const gross = (pv+bat+heat)*(1+vat);

  let grant=0, mode='Brak';
  if(pv>0 && heat>0 && bat===0){ mode='PV + magazyn ciepła'; grant = cap50(limPVHeat, pv+heat, share); }
  else if(pv>0 && bat>0){ mode='PV + magazyn energii'; grant = cap50(limPVBat, pv+bat, share); }
  else if(pv===0 && bat>0){ mode='Sam magazyn energii'; grant = cap50(limBatOnly, bat, share); }
  else if(pv>0 && bat===0 && heat===0){ mode='Tylko PV'; grant = 0; }

  const grossAfter = Math.max(0, gross - grant);

  const rows=[
    ['Tryb dotacji', mode],
    ['Koszt netto łącznie', money(pv+bat+heat)],
    ['VAT', Math.round(vat*100)+'%'],
    ['Brutto przed dotacją', money(gross)],
    ['Dotacja (po limicie '+Math.round(share*100)+'%)', money(grant)],
    ['Brutto po dotacji', money(grossAfter)]
  ];
  $('#rows').innerHTML = rows.map(([k,v])=>`<tr><th>${k}</th><td>${v}</td></tr>`).join('');
  $('#summary').textContent = 'Do zapłaty po dotacji: '+money(grossAfter);
}

$('#calc').onclick=recalc;
$('#print').onclick=()=>{ recalc(); window.print(); };
$('#reset').onclick=()=>{ ['cost_pv','cost_bat','cost_heat'].forEach(id=>$('#'+id).value='0'); recalc(); };

recalc();
</script>
</body>
</html>
