<!doctype html>
<html lang="pl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Komponenty ‚Ä¢ Pompy ciep≈Ça ‚Äî Midea, Panasonic, Galmet (pe≈Çny katalog)</title>

<style>
  :root{
    --bg:#0b1020;--p1:#121a34;--p2:#172142;--ink:#e8edff;--muted:#aeb8da;
    --accent:#4cc9f0;--ok:#2fbf71;--warn:#ffb84d;--bad:#ff6b6b;
    --grid:#243059;--card:#0f1533;--line:#1c2750
  }
  *{box-sizing:border-box}
  body{margin:0;background:linear-gradient(180deg,#0a0f1e,#0c1230 60%,#0a0f1e);color:var(--ink);
       font:15px/1.5 system-ui,Segoe UI,Roboto,Arial}
  header{padding:16px;background:#11183a;border-bottom:1px solid var(--line)}
  header h1{margin:6px 0 0;font-size:22px}
  .wrap{max-width:1500px;margin:auto;padding:16px}
  .grid{display:grid;gap:12px}
  @media(min-width:1100px){.cols-2{grid-template-columns:1.55fr 1fr}}
  .card{background:linear-gradient(180deg,var(--p1),var(--p2));border:1px solid var(--line);
        border-radius:14px;padding:14px}
  .row{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
  .row.spaced{justify-content:space-between}
  .right{margin-left:auto;display:flex;gap:8px}
  .btn{background:#233261;border:1px solid #3a4ca3;color:#fff;border-radius:10px;
       padding:8px 12px;cursor:pointer;text-decoration:none}
  .btn.ghost{background:transparent;border:1px dashed #3a4ca3}
  .btn.ok{background:#194d34;border-color:#2f9762}
  .btn.warn{background:#3a2a19;border-color:#9d7a33}
  .btn.bad{background:#3a1f2a;border-color:#7b3341}
  .tiny{font-size:12px}
  input,select,textarea{background:#0d1530;border:1px solid #28356c;border-radius:10px;
       padding:8px 10px;font:inherit;color:#e8edff}
  input::placeholder{color:#aeb8da99}
  .pill{display:inline-block;background:#0d1530;border:1px dashed #2b3a77;border-radius:999px;
        padding:6px 10px;color:#aeb8da;font-size:13px}
  .muted{color:var(--muted);font-size:13px}
  table{width:100%;border-collapse:separate;border-spacing:0}
  th,td{padding:10px;border-bottom:1px solid var(--grid);vertical-align:top;text-align:left}
  th{font-size:12px;color:#aeb8da;position:sticky;top:0;background:#151d46;z-index:1}
  tbody tr:hover{background:#0d153033}
  .small{font-size:12px;color:#aeb8da}
  .tag{display:inline-block;margin:2px 6px 0 0;padding:3px 8px;border:1px solid #3a4ca3;
       border-radius:999px;font-size:12px}
  .sep{height:1px;background:#243059;margin:10px 0}
  .okline{padding:8px;border-radius:10px;background:#0f2a22;border:1px solid #155a41;color:#b4ffdd}
  .warnline{padding:8px;border-radius:10px;background:#3a2a19;border:1px dashed #9d7a33;color:#ffdda1}
  .search{min-width:260px}
  .card.scroll{overflow:auto;max-height:70vh}
  .top-link{margin-top:8px}
  .hide{display:none}
  .flex1{flex:1}
  .minw240{min-width:240px}
  .right-align{text-align:right}
  .list-offset{margin:6px 0 0 18px}
</style>

<!-- XLSX do eksportu -->
<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
</head>
<body>
  <header>
    <div class="row spaced">
      <a href="index.html" class="btn ghost top-link">‚Üê Powr√≥t do pulpitu</a>
      <div class="right">
        <button id="btnToContractTop" class="btn ghost" title="Zapisz draft i przejd≈∫ do umowy">Wy≈õlij do umowy ‚Üí</button>
      </div>
    </div>
    <h1>Komponenty ‚Ä¢ Pompy ciep≈Ça ‚Äî Midea, Panasonic &amp; Galmet</h1>
    <div class="muted">
      Ceny wpisane <b>na sztywno</b>. Model proporcjonalny: najta≈Ñszy pakiet (pompa + bufor min + CWU min) =
      <b>38&nbsp;000 PLN netto</b>. Ka≈ºdy dro≈ºszy element podnosi cenƒô o <b>r√≥≈ºnicƒô</b>.
    </div>
  </header>

<div class="wrap grid cols-2">
  <!-- LEWA: Katalog + filtry -->
  <section class="grid">
    <div class="card">
      <div class="row">
        <input id="q" class="search" placeholder="üîé Szukaj: marka, model, tag‚Ä¶ / '10 kW', '8-12', '>=12'">
        <select id="fBrand"><option value="">Marka (wszystkie)</option></select>
        <select id="fType"><option value="">Typ</option><option>monoblok</option><option>split</option><option>all-in-one</option></select>
        <select id="fRef"><option value="">Czynnik</option><option>R32</option><option>R290</option></select>
        <select id="fPhase"><option value="">Fazy</option><option>1F</option><option>3F</option></select>
        <select id="sort" title="Sortowanie">
          <option value="brand.asc">Marka ‚Üë</option>
          <option value="brand.desc">Marka ‚Üì</option>
          <option value="p.asc">Moc ‚Üë</option>
          <option value="p.desc">Moc ‚Üì</option>
          <option value="price.asc">Cena urzƒÖdzenia ‚Üë</option>
          <option value="price.desc">Cena urzƒÖdzenia ‚Üì</option>
        </select>
        <button id="btnClear" class="btn ghost">Wyczy≈õƒá</button>
        <label class="small" style="margin-left:auto"><input type="checkbox" id="tagsAll"> dopasuj <b>wszystkie</b> tagi</label>
      </div>
      <div class="row" style="margin-top:6px">
        <div id="chips" class="row"></div>
        <span class="pill">≈ÅƒÖcznie: <b id="cntAll">0</b></span>
        <span class="pill">Widocznych: <b id="cntVis">0</b></span>
      </div>
      <div id="recQuick" class="okline hide" style="margin-top:8px"></div>
    </div>

    <div class="card scroll">
      <table>
        <thead>
          <tr>
            <th>Akcje</th>
            <th>Marka / Model</th>
            <th>Typ</th>
            <th>Moc A7 [kW]</th>
            <th>SCOP</th>
            <th>Czynnik</th>
            <th>Fazy</th>
            <th>Ha≈Ças [dB(A)]</th>
            <th>Uwagi</th>
          </tr>
        </thead>
        <tbody id="tbody"></tbody>
      </table>
      <div class="small muted" style="margin-top:6px">Uwaga: ceny urzƒÖdze≈Ñ nie sƒÖ pokazywane w tabeli (do wyceny u≈ºyj konfiguratora po prawej).</div>
    </div>
  </section>

  <!-- PRAWA: Konfigurator + koszyk -->
  <aside class="grid">
    <div class="card">
      <div class="row spaced">
        <b>Konfigurator zestawu</b>
        <div class="right">
          <button id="btnAddPack" class="btn ok">+ Dodaj ZESTAW</button>
          <button id="btnAddHp" class="btn warn">+ Sama pompa</button>
        </div>
      </div>

      <div class="row" style="margin-top:8px">
        <div><label class="small">Model pompy</label><select id="selHp"></select></div>
        <div><label class="small">Bufor [l]</label><select id="selBufor"></select></div>
        <div><label class="small">Typ zasobnika CWU</label>
          <select id="selCwuType"><option value="single" selected>pojedyncza wƒô≈ºownica</option><option value="dual">dwuwƒô≈ºownicowy</option></select>
        </div>
        <div><label class="small">Zasobnik CWU [l]</label><select id="selCwu"></select></div>
        <div><label class="small">Cel u≈ºycia CWU</label>
          <select id="selCwuUse"><option value="2-3">2‚Äì3 osoby (200‚Äì250 l)</option><option value="4-5" selected>4‚Äì5 os√≥b (250‚Äì300 l)</option><option value="6+">6+ os√≥b (300+ l)</option></select>
        </div>
        <div><label class="small">VAT</label><select id="selVat"><option value="0.08" selected>8%</option><option value="0.23">23%</option><option value="0">0%</option></select></div>
        <div><label class="small">Zaw√≥r 3-drogowy</label><select id="selV3d"><option value="0">w zestawie</option><option value="450">+450</option></select></div>
        <div><label class="small">Grupa bezpiecze≈Ñstwa</label><select id="selSafety"><option value="0">w zestawie</option><option value="390">+390</option></select></div>
        <div><label class="small">Hydraulika (rozdzielacze)</label><select id="selHydro"><option value="0">podstawowa</option><option value="1800">+1 obieg (1800)</option><option value="3200">dwa obiegi (3200)</option></select></div>
        <div><label class="small">Glikol (monoblok)</label><select id="selGlycol"><option value="0">nie</option><option value="600">30 l (600)</option><option value="900">50 l (900)</option></select></div>
      </div>

      <div class="sep"></div>
      <b>Dob√≥r mocy ‚Äî wariant prosty</b>
      <div class="row" style="margin-top:8px">
        <div><label class="small">Powierzchnia [m¬≤]</label><input id="inpArea" type="number" min="0" step="1" value="0" style="width:110px"></div>
        <div><label class="small">Straty [W/m¬≤]</label>
          <select id="selWperm2" style="width:140px"><option value="35">Nowy ‚Äî 35</option><option value="45">Nowszy ‚Äî 45</option><option value="50" selected>Modernizacja ‚Äî 50</option><option value="60">Starszy ‚Äî 60</option><option value="70">Bardzo stary ‚Äî 70</option></select>
        </div>
        <div>
          <label class="small">Propozycja mocy [kW]</label>
          <input id="outHeatKw" type="text" value="0.00" readonly style="width:110px">
          <div class="small muted">m¬≤ √ó W/m¬≤ √∑ 1000 √ó 1.10</div>
        </div>
      </div>

      <div id="typeHint" class="okline hide" style="margin-top:8px"></div>

      <div class="sep"></div>
      <b>Dob√≥r mocy ‚Äî wariant rozbudowany</b>
      <div class="row" style="margin-top:8px">
        <div><label class="small">Standard</label>
          <select id="selStd"><option value="35">Nowy/NZEB (~35)</option><option value="50" selected>Modernizacja (~50)</option><option value="80">Stary (~80)</option></select>
        </div>
        <div><label class="small">Powierzchnia [m¬≤]</label><input id="areaAdv" type="number" min="30" step="1" style="width:110px"></div>
        <div><label class="small">Straty [W/m¬≤]</label><input id="lossWm2" type="number" value="70" min="10" step="5" style="width:110px"></div>
      </div>
      <div id="lossWarn" class="warnline hide" style="margin-top:8px">&gt; 140 W/m¬≤ ‚Äî niezalecane</div>
      <div class="row" style="margin-top:8px">
        <span class="pill">ObciƒÖ≈ºenie projektowe: <b id="heatLoad">‚Äî</b></span>
        <span class="pill">Zapas 15%: <b id="heatTarget">‚Äî</b></span>
        <span class="pill">Pow. pokrywana wybranƒÖ pompƒÖ: <b id="areaByHp">‚Äî</b></span>
      </div>
      <div id="areaHint" class="small muted" style="margin-top:6px"></div>
      <div id="recSummary" class="okline hide" style="margin-top:8px"></div>

      <div class="sep"></div>
      <div class="row">
        <div class="flex1">
          <div class="muted">Cena zestawu (netto) wg modelu proporcjonalnego</div>
          <div id="pricePreview" style="font-weight:800;font-size:18px">‚Äî</div>
        </div>
        <div class="minw240">
          <label class="small">Prowizja handlowca</label>
          <div class="row">
            <input id="provPct" type="number" min="0" step="0.1" placeholder="%" style="width:80px">
            <input id="provAbs" type="number" min="0" step="1" placeholder="PLN" style="width:130px">
          </div>
          <div class="small muted">Mo≈ºesz wpisaƒá % i/lub PLN (sumujƒÖ siƒô).</div>
        </div>
      </div>
    </div>

    <div class="card">
      <b>Sk≈Çad zestawu (must-have)</b>
      <div id="mustHave" class="muted" style="margin-top:6px">Wybierz pompƒô, bufor i zasobnik ‚Äî poka≈ºƒô sk≈Çad.</div>
    </div>

    <div class="card">
      <b>Koszyk</b>
      <table id="basket" class="mt8">
        <thead><tr><th>Pozycja</th><th>Ilo≈õƒá</th><th class="right">Cena [PLN]</th><th></th></tr></thead>
        <tbody></tbody>
      </table>
      <div class="sep"></div>
      <div class="row">
        <div><span class="muted">Suma netto</span><div id="sumNet" style="font-weight:800;font-size:18px">0,00 PLN</div></div>
        <div><span class="muted">Prowizja</span><div id="sumProv" style="font-weight:800;font-size:18px">0,00 PLN</div></div>
        <div><span class="muted">Brutto (z VAT)</span><div id="sumGross" style="font-weight:800;font-size:18px">0,00 PLN</div></div>
        <div class="right">
          <button id="btnCopy" class="btn ghost">Kopiuj ofertƒô</button>
          <button id="btnPrint" class="btn ghost">Drukuj / PDF</button>
          <button id="btnXlsx" class="btn ghost">Eksport XLSX</button>
          <button id="btnExportJson" class="btn ghost">Eksport JSON</button>
          <button id="btnImportJson" class="btn ghost">Import JSON</button>
        </div>
      </div>
    </div>

    <div class="card">
      <b>Baza klient√≥w</b>
      <div class="row" style="margin-top:6px">
        <div><label class="small">Imiƒô i nazwisko / Firma</label><input id="clName" placeholder="np. Jan Kowalski" style="width:180px"></div>
        <div><label class="small">E-mail</label><input id="clEmail" placeholder="np. jan@firma.pl" style="width:180px"></div>
        <div><label class="small">Telefon</label><input id="clPhone" placeholder="np. 600123123" style="width:130px"></div>
        <div><label class="small">NIP (opcjonalnie)</label><input id="clNip" placeholder="NIP" style="width:130px"></div>
        <div><label class="small">Adres</label><input id="clAddr" placeholder="ulica, miasto" style="width:220px"></div>
      </div>
      <div class="row" style="margin-top:6px">
        <button id="btnSaveClient" class="btn ok">Zapisz klienta do bazy</button>
        <select id="selClient" style="width:240px"><option value="">‚Äî wybierz z bazy ‚Äî</option></select>
        <button id="btnLoadClient" class="btn ghost">Wczytaj</button>
        <button id="btnToContract" class="btn">Wy≈õlij do umowy</button>
        <button id="btnMailTo" class="btn ghost">Wy≈õlij ofertƒô e-mailem</button>
      </div>
      <div class="small muted" style="margin-top:6px">Dane klient√≥w i projekty um√≥w sƒÖ lokalne (local/sessionStorage).</div>
    </div>
  </aside>
</div>

<!-- LOGIKA -->
<script src="pompy.js" defer></script>
</body>
</html>
